<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>12 Regras de Ouro ‚Äì Para um Ano Mais Seguro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:20px;
}
.container{
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h1,h2,h3{text-align:center}
.hidden{display:none}
input,select{
  width:100%;
  padding:10px;
  margin-bottom:12px;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  background:#2e7d32;
  color:#fff;
  border:none;
  padding:12px 18px;
  border-radius:6px;
  cursor:pointer;
  font-size:16px;
}
button:hover{background:#256428}
.question{
  background:#fafafa;
  padding:12px;
  border-radius:6px;
  margin-bottom:12px;
  border-left:6px solid #ccc;
}
.question.correct{
  border-left-color:#2e7d32;
  background:#e8f5e9;
}
.question.wrong{
  border-left-color:#c62828;
  background:#fdecea;
}
.ranking{
  background:#f1f8e9;
  padding:15px;
  border-radius:8px;
  margin-top:30px;
}
.msg{
  margin-top:15px;
  font-weight:bold;
  color:#2e7d32;
  white-space:pre-line;
}
.escudo{
  display:block;
  margin:0 auto 15px;
  max-width:140px;
}
.selo{
  width:140px;
  padding:10px;
  border-radius:8px;
  background:#e8f5e9;
  border:2px solid #2e7d32;
  text-align:center;
  font-weight:bold;
  font-size:13px;
}
</style>
</head>

<body>

<div class="container">

<img src="escudo.png" class="escudo" alt="Escudo 12 Regras de Ouro">

<h1>12 Regras de Ouro</h1>
<h2>Para um Ano Mais Seguro</h2>

<!-- LOGIN -->
<div id="login">
  <h3>Identifica√ß√£o do participante</h3>
  <input id="nome" placeholder="Nome completo">
  <select id="unidade">
    <option value="">Selecione a unidade</option>
    <option>SEDE</option>
    <option>HUC</option>
    <option>PAUC/CIS</option>
    <option>CQA/CCO</option>
    <option>AMPLIA</option>
    <option>CPS</option>
    <option>ADUC</option>
    <option>CCI</option>
  </select>
  <button onclick="start()">Iniciar Desafio</button>
</div>

<!-- JOGO -->
<div id="jogo" class="hidden">
  <h3 id="tituloRegra"></h3>
  <div id="perguntas"></div>
  <button onclick="concluirRegra()">Concluir Regra</button>
  <div id="mensagem" class="msg"></div>
</div>

<!-- RANKING -->
<div class="ranking">
  <h3>üèÜ Ranking Geral</h3>
  <div id="ranking"></div>
</div>

<!-- SELOS -->
<div class="ranking">
  <h3>üèÖ Selos Conquistados</h3>
  <div id="selos" style="display:flex;flex-wrap:wrap;gap:10px;"></div>
</div>

</div>

<script>
/* =========================
   VARI√ÅVEIS GLOBAIS
========================= */
let jogador = {};
let pontos = 0;
let regraAtual = 0;

/* =========================
   CONFIGURA√á√ïES
========================= */
const PONTUACAO_MINIMA = 42; // 70%

/* =========================
   MAPA MENSAL
========================= */
const regrasPorMes = {
  0:[0,1],1:[2],2:[3],3:[4],4:[5],5:[6],
  6:[7],7:[8],8:[9],9:[10],10:[11]
};

/* =========================
   N√çVEIS DE PREVEN√á√ÉO
========================= */
const niveis = [
  { nivel:1, nome:"Aten√ß√£o B√°sica", regras:[0,1] },
  { nivel:2, nome:"Preven√ß√£o Essencial", regras:[2,3,4,5] },
  { nivel:3, nome:"Seguran√ßa Estruturada", regras:[6,7,8,9] },
  { nivel:4, nome:"Sa√∫de Segura", regras:[10,11], final:true }
];

/* =========================
   REGRAS (exemplo 1 e 2)
========================= */
const regras = [
  {titulo:"Regra 01 ‚Äì Aten√ß√£o no Trajeto",p:[
    ["Manter aten√ß√£o no trajeto reduz acidentes.",true],
    ["Usar celular ao caminhar n√£o traz riscos.",false],
    ["Distra√ß√£o aumenta o risco de quedas.",true],
    ["Cansa√ßo n√£o interfere na seguran√ßa.",false],
    ["Olhar o caminho ajuda a identificar riscos.",true],
    ["Ignorar obst√°culos √© seguro.",false]
  ]},
  {titulo:"Regra 02 ‚Äì Olhos no Caminho",p:[
    ["Observar o caminho ajuda a identificar riscos.",true],
    ["Distra√ß√µes aumentam risco de quedas.",true],
    ["Olhar o caminho elimina todos os riscos.",false],
    ["Pisos molhados exigem aten√ß√£o redobrada.",true],
    ["Caminhar olhando o celular √© seguro.",false],
    ["Objetos no ch√£o causam trope√ßos.",true]
  ]}
];

/* =========================
   FUN√á√ïES BASE
========================= */
function regraLiberada(i){
  return regrasPorMes[new Date().getMonth()]?.includes(i);
}

function start(){
  const nome=document.getElementById("nome").value.trim();
  const unidade=document.getElementById("unidade").value;
  if(!nome||!unidade){alert("Preencha nome e unidade");return;}
  jogador={nome,unidade};
  pontos=0; regraAtual=0;
  document.getElementById("login").classList.add("hidden");
  document.getElementById("jogo").classList.remove("hidden");
  carregarRegra();
}

function carregarRegra(){
  document.getElementById("mensagem").innerText="";
  if(!regraLiberada(regraAtual)){
    document.getElementById("tituloRegra").innerText="‚è≥ Regra ainda n√£o liberada";
    document.getElementById("perguntas").innerHTML=
      "<p>Aguarde a pr√≥xima regra mensal para continuar.</p>";
    return;
  }
  const r=regras[regraAtual];
  document.getElementById("tituloRegra").innerText=r.titulo;
  const div=document.getElementById("perguntas");
  div.innerHTML="";
  r.p.forEach((q,i)=>{
    div.innerHTML+=`
      <div class="question">
        <p>${i+1}. ${q[0]}</p>
        <label><input type="radio" name="q${i}" value="true"> Verdadeiro</label><br>
        <label><input type="radio" name="q${i}" value="false"> Falso</label>
      </div>`;
  });
}

/* =========================
   CONCLUS√ÉO COM 70%
========================= */
function concluirRegra(){
  let pontosRegra=0;
  document.querySelectorAll(".question").forEach((q,i)=>{
    const m=document.querySelector(`input[name="q${i}"]:checked`);
    if(m && (m.value==="true")===regras[regraAtual].p[i][1]){
      pontosRegra+=10; q.classList.add("correct");
    }else q.classList.add("wrong");
  });

  if(pontosRegra<PONTUACAO_MINIMA){
    document.getElementById("mensagem").innerText=
      `‚ùå Pontua√ß√£o insuficiente (${pontosRegra}/60).\n√â necess√°rio no m√≠nimo 70%.`;
    return;
  }

  pontos+=pontosRegra;
  salvarRanking();
  salvarSelo(regraAtual);
  verificarCertificadoNivel();

  document.getElementById("mensagem").innerText=
    `‚úÖ Regra conclu√≠da!\nPontua√ß√£o da regra: ${pontosRegra} pts`;

  regraAtual++;
  setTimeout(carregarRegra,1500);
}

/* =========================
   RANKING
========================= */
function salvarRanking(){
  let r=JSON.parse(localStorage.getItem("ranking"))||[];
  r.push({nome:jogador.nome,unidade:jogador.unidade,pontos});
  localStorage.setItem("ranking",JSON.stringify(r));
  carregarRanking();
}

function carregarRanking(){
  let r=JSON.parse(localStorage.getItem("ranking"))||[];
  r.sort((a,b)=>b.pontos-a.pontos);
  document.getElementById("ranking").innerHTML=
    "<ol>"+r.map(x=>`<li>${x.nome} (${x.unidade}) ‚Äì ${x.pontos} pts</li>`).join("")+"</ol>";
}

/* =========================
   SELOS
========================= */
function salvarSelo(i){
  let s=JSON.parse(localStorage.getItem("selos"))||[];
  if(!s.includes(i)){s.push(i);}
  localStorage.setItem("selos",JSON.stringify(s));
  carregarSelos();
}

function carregarSelos(){
  const d=document.getElementById("selos");
  let s=JSON.parse(localStorage.getItem("selos"))||[];
  d.innerHTML=s.length
    ? s.map(i=>`<div class="selo">üèÖ<br>${regras[i].titulo}</div>`).join("")
    : "<p>Nenhum selo conquistado ainda.</p>";
}

/* =========================
   CERTIFICADO POR N√çVEL
========================= */
function verificarCertificadoNivel(){
  const selos=JSON.parse(localStorage.getItem("selos"))||[];
  let certificados=JSON.parse(localStorage.getItem("certificados"))||[];

  niveis.forEach(n=>{
    if(n.regras.every(r=>selos.includes(r)) && !certificados.includes(n.nivel)){
      certificados.push(n.nivel);
      localStorage.setItem("certificados",JSON.stringify(certificados));
      gerarCertificado(n);
    }
  });
}

function gerarCertificado(n){
  alert(
    `üéì CERTIFICADO CONQUISTADO!\n\n${jogador.nome}\n`+
    `concluiu o ${n.nivel}¬∫ N√≠vel da Preven√ß√£o\n${n.nome}\n\n`+
    `Campanha: 12 Regras de Ouro para um Ano Mais Seguro`
  );
}

carregarRanking();
carregarSelos();
</script>

</body>
</html>
